<html
    window-resizable="true"
    window-width="700dip"
    window-height="400dip"
>
<head>
<title>sciter dialogs demo</title>
<style>

body {
    border-spacing: 1em;
}

plaintext#logger {
    height: *;
}

@import url(vendor/8ctopus/sciter-logger/src/logger.css)

</style>
<script type="module">

import {logger} from "vendor/8ctopus/sciter-logger/src/logger.js";
import {addReloadWindow, centerWindow} from "vendor/8ctopus/sciter-utils/src/utils.js";

import {dialogs} from "src/dialogs.js";

document.on("ready", function() {
    // initialize logger
    logger.init("", false);

    // subscribe to logger messages
    logger.subscribe(function(level, message) {
        const log = document.$("plaintext#logger");

        log.append(JSX(level, {}, [message]));

        // scroll to last item
        log.lastElementChild.scrollIntoView({behavior: "smooth"});
    });

    // attach logger to console
    logger.attach();

    // capture unhandled exceptions
    logger.capture();

    // add support for F5 reload
    addReloadWindow();

    // center window on screen
    centerWindow();
});

// set dialog buttons on click event
document.on("click", "button", function(event, element) {
    let value;

    switch (element.id) {
        case "info":
            value = dialogs.show("info", "Widget update successful.", "ok");
            break;

        case "error":
            value = dialogs.show("error", "Widget failed with error 18.", "ok help[https://duckduckgo.com]");
            break;

        case "warning":
            value = dialogs.show("warning", "Widget could not be updated. Lorem ipsum dolor sit amet consectetur, adipisicing elit. Nemo ratione molestias optio dolorem blanditiis commodi maiores, libero expedita dolor quo, sequi ipsum iusto! Nostrum quas modi, saepe a aspernatur nemo.", "ok");
            break;

        case "question":
            value = dialogs.show("question", "Do you want to update widget?", "yes no cancel");
            break;

        case "callback":
            value = dialogs.show("info", "The callback can be used to translate the dialog elements.", "ok", {callback: dialogCallback });
            break;

        case "css":
            let options = {
                css: [
                    "src\\dialog-win.css",
                    "css\\test.css",
                ]

                //css: "css\\test.css"
            };

            value = dialogs.show("info", "Widget update successful.", "ok", options);
            break;

        case "options":
            // options that apply to all dialogs
            dialogs.setOptions({
                callback: dialogCallback,
                css: [
                    "src\\dialog-win.css",
                    "css\\test.css",
                ]
            });
            break;

        case "reset":
            dialogs.setOptions({});
            break;

        default:
            console.error(`unknown element ${element.id}`);
            break;
    }

    console.debug(`return value: ${value}`);
});

/**
 * Dialog callback
 * @param DOMElement root
 * @return void
 */
function dialogCallback(root)
{
    console.debug("dialog callback reached");

    // get all dialog elements to translate
    root.$$("[data-i18n]").map(function(element) {
        element.innerHTML += " (i18n)";
    });
}

</script>
</head>
<body>
    <button #info>info</button>
    <button #error>error</button>
    <button #warning>warning</button>
    <button #question>question</button>
    <button #callback>callback</button>
    <button #css>custom css</button>
    <button #options>options for all</button>
    <button #reset>options for none</button>
    <plaintext #logger readonly />
</body>
</html>
